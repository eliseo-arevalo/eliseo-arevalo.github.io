<header
  class={`
    flex justify-center items-center
    mx-auto
    py-5
    sticky top-0
    lg:w-[740px]
    z-10
  `}
>
  <nav
    class={`
      rounded-full
      px-2 py-1 sm:px-3
      flex flex-row items-center
      backdrop-blur-2xl
      gap-x-4 sm:gap-x-6 lg:gap-x-10 opacity-80
      text-sm sm:text-base
      `}
  >
    <!-- Desktop Navigation -->
    <div class="hidden sm:flex items-center gap-x-6 lg:gap-x-10">
      <a
        class="hover:scale-110 hover:bg-white/20 rounded-full transition px-2"
        href="/"
        >Inicio
      </a>
      <a
        class="hover:scale-110 hover:bg-white/20 rounded-full transition px-2"
        href="/#experiencia"
        >Experiencia
      </a>
      <a
        class="hover:scale-110 hover:bg-white/20 rounded-full transition px-2"
        href="/#proyectos"
        >Proyectos
      </a>
      <a
        class="hover:scale-110 hover:bg-white/20 rounded-full transition px-2"
        href="/notas"
        >Notas
      </a>
    </div>

    <!-- Mobile Navigation -->
    <div class="sm:hidden flex items-center gap-x-4">
      <div class="relative">
        <button
          id="mobile-menu-toggle"
          class="flex items-center gap-1 hover:bg-white/20 rounded-full transition px-2 py-1"
        >
          Inicio
          <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
          </svg>
        </button>
        <div
          id="mobile-dropdown"
          class="absolute top-full left-0 mt-2 bg-white/90 dark:bg-black/80 backdrop-blur-2xl rounded-lg py-2 min-w-32 hidden border border-gray-200 dark:border-gray-700"
        >
          <a href="/" class="block px-3 py-2 hover:bg-white/20 transition" onclick="document.getElementById('mobile-dropdown').classList.add('hidden')">Inicio</a>
          <a href="/#experiencia" class="block px-3 py-2 hover:bg-white/20 transition" onclick="document.getElementById('mobile-dropdown').classList.add('hidden')">Experiencia</a>
          <a href="/#proyectos" class="block px-3 py-2 hover:bg-white/20 transition" onclick="document.getElementById('mobile-dropdown').classList.add('hidden')">Proyectos</a>
        </div>
      </div>
      <a
        class="hover:bg-white/20 rounded-full transition px-2 py-1"
        href="/notas"
        >Notas
      </a>
    </div>

    <button
      id="theme-toggle"
      class="ml-2 sm:ml-4 p-1 sm:p-2 rounded-full hover:bg-white/20 transition"
      title="Cambiar tema"
      type="button"
    >
      <svg
        id="theme-toggle-light-icon"
        class="w-5 h-5 hidden"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="1.8"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <circle cx="12" cy="12" r="4" />
        <path d="M12 3v1.8" />
        <path d="M12 19.2V21" />
        <path d="M4.22 4.22 5.5 5.5" />
        <path d="M18.5 18.5 19.78 19.78" />
        <path d="M3 12h1.8" />
        <path d="M19.2 12H21" />
        <path d="M4.22 19.78 5.5 18.5" />
        <path d="M18.5 5.5 19.78 4.22" />
      </svg>
      <svg id="theme-toggle-dark-icon" class="w-5 h-5 hidden" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z" />
      </svg>
    </button>
  </nav>
</header>

<script>
  // Mobile menu toggle
  const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
  const mobileDropdown = document.getElementById('mobile-dropdown');

  if (mobileMenuToggle && mobileDropdown) {
    mobileMenuToggle.addEventListener('click', function() {
      mobileDropdown.classList.toggle('hidden');
    });

    // Close dropdown when clicking outside
    document.addEventListener('click', function(event) {
      if (!mobileMenuToggle.contains(event.target) && !mobileDropdown.contains(event.target)) {
        mobileDropdown.classList.add('hidden');
      }
    });
  }

  // Theme toggle logic
  const themeToggleBtn = document.getElementById('theme-toggle');
  const lightIcon = document.getElementById('theme-toggle-light-icon');
  const darkIcon = document.getElementById('theme-toggle-dark-icon');

  // Inicializa el icono correcto
  function updateThemeIcon() {
    if (!lightIcon || !darkIcon) return; // Null check

    if (
      localStorage.getItem('theme') === 'dark' ||
      (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches)
    ) {
      document.documentElement.classList.add('dark');
      darkIcon.classList.remove('hidden');
      lightIcon.classList.add('hidden');
    } else {
      document.documentElement.classList.remove('dark');
      lightIcon.classList.remove('hidden');
      darkIcon.classList.add('hidden');
    }
  }

  updateThemeIcon();

  if (themeToggleBtn) { // Null check
    themeToggleBtn.addEventListener('click', function () {
      if (document.documentElement.classList.contains('dark')) {
        document.documentElement.classList.remove('dark');
        localStorage.setItem('theme', 'light');
      } else {
        document.documentElement.classList.add('dark');
        localStorage.setItem('theme', 'dark');
      }
      updateThemeIcon();
    });
  }
</script>
