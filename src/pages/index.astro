---
import Layout from "@/layouts/Layout.astro"

import AboutMe from "@/components/AboutMe.astro"
import Badge from "@/components/Badge.astro"
import Briefcase from "@/components/icons/Briefcase.astro"
import CodeIcon from "@/components/icons/Code.astro"
import Experience from "@/components/Experience.astro"
import GitHubIcon from "@/components/icons/GitHub.astro"
import LinkedInIcon from "@/components/icons/LinkedIn.astro"
import MailIcon from "@/components/icons/Mail.astro"
import CVIcon from "../components/icons/CV.astro"
import ProfileCheck from "@/components/icons/ProfileCheck.astro"
import Projects from "@/components/Projects.astro"
import SectionContainer from "@/components/SectionContainer.astro"
import SocialPill from "@/components/SocialPill.astro"
---

<Layout
	title="Eliseo - Desarrollador Fullstack"
	description="Conoce mas de Eliseo Arévalo, desarrollador fullstack .net y javascript"
>
	<main class="px-4">
		<SectionContainer
			id="top"
			class="py-10 pb-16 flex flex-col items-center"
		>
			<div class="relative mx-auto max-w-4xl overflow-hidden">
				<div class="px-6 py-8">
					<div class="flex items-center gap-3">
						<img
							class="h-12 w-12 rounded-full ring-2 ring-white dark:ring-black border border-white/20 dark:border-white/10 object-cover"
							src="/eliseo.png"
							alt="Foto de Eliseo Arévalo"
						/>
						<span class="inline-flex items-center gap-2 rounded-full border border-sky-200 dark:border-sky-900 bg-sky-50 text-sky-700 dark:bg-sky-500/10 dark:text-sky-300 px-3 py-1 text-xs">
							<span class="inline-block h-2 w-2 rounded-full bg-sky-500"></span>
							Disponible para trabajar
						</span>
					</div>
			<h1
				class="text-gray-900 dark:text-white text-3xl md:text-4xl lg:text-5xl font-bold flex flex-row gap-x-4 pb-6 mt-3"
			>
				Eliseo Arévalo <a
					href="https://www.linkedin.com/company/serfinsa/mycompany/"
					target="_blank"
					rel="noopener"
					class="flex justify-center items-center hover:scale-105 transition"
				>
					<Badge>develiseo</Badge>
				</a>
			</h1>
			<h2
				class="text-xl lg:text-xl text-balance max-w-[700px] text-black dark:text-white"
			>
				<span>Si puedes hacer algo increible, ¿Por qué</span><span
					class="text-yellow-800 dark:text-yellow-200"
				>
				conformarte con menos?</span
				> </span>
				
			</h2>
			<nav class="flex gap-4 mt-8 flex-wrap">
				<SocialPill href="http://linkedin.com/in/eliseo-arevalo">
					<LinkedInIcon class="size-4 md:size-6" />
					LinkedIn
				</SocialPill>
				<SocialPill href="https://github.com/eliseo-arevalo">
					<GitHubIcon class="size-4 md:size-6" />
					GitHub
				</SocialPill>
				<!-- <SocialPill href="mailto:enriquejulio071@gmail.com">
					<MailIcon class="size-4 md:size-6" />
					 enriquejulio071
				</SocialPill> -->
				<!-- <SocialPill
					href="/EliseoArevaloCV.pdf"
				>
					<CVIcon class="size-4 md:size-6" />
					Curriculum
				</SocialPill> -->
			</nav>
				</div>
			</div>
		</SectionContainer>

		<SectionContainer id="experiencia">
			<h2
				class="text-3xl font-semibold mb-6 flex gap-x-3 items-center text-black/80 dark:text-white/80"
			>
				<Briefcase class="size-7" />
				Experiencia laboral
			</h2>
			<Experience />
		</SectionContainer>

		<SectionContainer id="proyectos">
			<h2
				class="text-3xl font-semibold mb-6 flex gap-x-3 items-center text-black/80 dark:text-white/80"
			>
				<CodeIcon class="size-7" />
				Proyectos
			</h2>
			<Projects />
		</SectionContainer>

		<SectionContainer id="sobre-mi">
			<h2
				class="text-3xl font-semibold mb-6 flex gap-x-3 items-center text-black/80 dark:text-white/80"
			>
				<ProfileCheck class="size-7" />
				Sobre mí
			</h2>
			<AboutMe />
		</SectionContainer>

		<!-- Spotify Widget -->
		<div class="w-full px-4 mt-8">
			<div class="w-full mx-auto lg:w-[740px]">
				<div style="border-radius: 12px; overflow: hidden; background: transparent; position: relative;">
					<!-- Loading State -->
					<div id="spotify-loading" class="absolute inset-0 bg-gray-100 dark:bg-gray-800 flex items-center justify-center z-10">
						<div class="flex flex-col items-center gap-3">
							<div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center animate-pulse">
								<svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 24 24">
									<path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.44-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.42 1.56-.299.421-1.02.599-1.559.3z"/>
								</svg>
							</div>
							<div class="text-sm text-gray-600 dark:text-gray-400">Cargando música...</div>
						</div>
					</div>
					
					<iframe 
						id="spotify-iframe"
						src="https://open.spotify.com/embed/track/0pxPNTroZcxXA0w6IDgMQJ?utm_source=generator&theme=0" 
						width="100%" 
						height="152" 
						frameBorder="0" 
						allowfullscreen="" 
						allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" 
						loading="lazy"
						style="border: none; border-radius: 0; background: transparent;"
						data-theme="light"
					></iframe>
				</div>
			</div>
		</div>
	</main>

	<script>
		// Ocultar loading cuando el iframe se carga
		function hideSpotifyLoading() {
			const loading = document.getElementById('spotify-loading');
			if (loading) {
				loading.style.opacity = '0';
				setTimeout(() => {
					loading.style.display = 'none';
				}, 300);
			}
		}
		
		// Detectar cuando el iframe está listo
		document.addEventListener('DOMContentLoaded', function() {
			const iframe = document.getElementById('spotify-iframe');
			if (iframe) {
				// Múltiples métodos para detectar cuando está listo
				iframe.addEventListener('load', hideSpotifyLoading);
				
				// Fallback: ocultar después de un tiempo razonable
				setTimeout(() => {
					hideSpotifyLoading();
				}, 3000);
			}
		});
		
		// Cambiar tema del widget de Spotify según el tema del sitio
		function updateSpotifyTheme() {
			const iframe = document.querySelector('iframe[src*="spotify.com"]');
			if (!iframe) return;
			
			const isDark = document.documentElement.classList.contains('dark');
			const currentSrc = iframe.src;
			// Corrección: theme=0 es oscuro, theme=1 es claro
			const newTheme = isDark ? '0' : '1';
			
			// Solo actualizar si el tema cambió
			if (currentSrc.includes(`theme=${newTheme}`)) return;
			
			const newSrc = currentSrc.replace(/theme=[01]/, `theme=${newTheme}`);
			iframe.src = newSrc;
		}
		
		// Observar cambios en el tema
		const observer = new MutationObserver(updateSpotifyTheme);
		observer.observe(document.documentElement, { 
			attributes: true, 
			attributeFilter: ['class'] 
		});
		
		// Actualizar al cargar la página
		updateSpotifyTheme();
	</script>
</Layout>
