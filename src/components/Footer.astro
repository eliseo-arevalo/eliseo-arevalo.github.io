---
const currentYear = new Date().getFullYear()
---

<!-- Spotify Widget -->
<div class="w-full px-4 mt-16">
  <div class="w-full mx-auto lg:w-[740px]">
    <div style="border-radius: 12px; overflow: hidden; background: transparent;">
      <iframe 
        src="https://open.spotify.com/embed/track/0pxPNTroZcxXA0w6IDgMQJ?utm_source=generator&theme=0" 
        width="100%" 
        height="152" 
        frameBorder="0" 
        allowfullscreen="" 
        allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" 
        loading="lazy"
        style="border: none; border-radius: 0; background: transparent;"
        data-theme="light"
      ></iframe>
    </div>
  </div>
</div>

<script>
  // Cambiar tema del widget de Spotify según el tema del sitio
  function updateSpotifyTheme() {
    const iframe = document.querySelector('iframe[src*="spotify.com"]');
    if (!iframe) return;
    
    const isDark = document.documentElement.classList.contains('dark');
    const currentSrc = iframe.src;
    // Corrección: theme=0 es oscuro, theme=1 es claro
    const newTheme = isDark ? '0' : '1';
    
    // Solo actualizar si el tema cambió
    if (currentSrc.includes(`theme=${newTheme}`)) return;
    
    const newSrc = currentSrc.replace(/theme=[01]/, `theme=${newTheme}`);
    iframe.src = newSrc;
  }
  
  // Observar cambios en el tema
  const observer = new MutationObserver(updateSpotifyTheme);
  observer.observe(document.documentElement, { 
    attributes: true, 
    attributeFilter: ['class'] 
  });
  
  // Actualizar al cargar la página
  updateSpotifyTheme();
</script>

<footer class="mt-8 w-full px-4">
  <div class="w-full mx-auto lg:w-[740px] border-t border-gray-200 dark:border-gray-800 py-6 flex flex-col sm:flex-row items-center justify-between gap-3 text-sm text-gray-700 dark:text-gray-300">
    <span>© {currentYear} Eliseo Arévalo</span>
    <nav class="flex gap-4">
      <a href="#experiencia" class="hover:text-sky-600 dark:hover:text-sky-400">Experiencia</a>
      <a href="#proyectos" class="hover:text-sky-600 dark:hover:text-sky-400">Proyectos</a>
      <a href="#sobre-mi" class="hover:text-sky-600 dark:hover:text-sky-400">Sobre mí</a>
      <a href="/notas" class="hover:text-sky-600 dark:hover:text-sky-400">Notas</a>
    </nav>
  </div>
</footer>
